USE Valorant;

-- Creer une partie 1
INSERT INTO `match_game` (`date_heure_m`, `Id_Map`, `Id_Resultat`) VALUES ('2023-01-05 20:35:09', '7', '1');

--  Partie 1
INSERT INTO `joueur` (`nom_uti_j`, `tue_j`, `mort_j`, `assist_j`, `Id_Equipe`, `Id_Arme`, `Id_Personnage`, `Id_Rang`, `Id_Match_game`) VALUES
    (               'Tarzan',   '16',   '2',      '8',        '1',    '13',         '5',       '3',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Randy',   '6',    '6',     '6',       '1',      '5',        '1',        '2',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Typhanie','12',   '4',     '4',       '1',      '5',       '5',        '3',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Katy',    '19',   '3',     '8',       '1',      '2',        '2',        '8',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Elliot',  '4',    '9',     '7',       '1',      '5',        '12',       '1',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Trinh',   '3',    '15',    '2',       '2',      '7',        '14',       '6',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Ryo',     '9',    '12',    '3',       '2',      '9',        '8',        '9',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Yui',     '12',   '8',     '6',       '2',      '11',       '19',       '2',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Dictateur Africain',    '30',   '5',     '1',       '2',      '13',       '4',        '4',     '1');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Kana',    '2',    '3',     '4',       '2',      '2',       '7',        '7',     '1');


-- Creer une partie 2
INSERT INTO `match_game` (`date_heure_m`, `Id_Map`, `Id_Resultat`) VALUES ('2022-12-23 16:20:54', '5', '2');

--  Partie 2
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Rina',    '11',   '7',     '8',       '1',      '1',       '3',        '1',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Mika',    '16',   '4',     '7',       '1',      '3',        '9',        '3',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Nana',    '7',    '6',     '8',       '1',      '1',        '20',       '5',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Yuna',    '8',    '3',     '9',       '1',      '16',       '17',       '5',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Eiji',    '14',   '9',     '9',       '1',      '4',        '18',       '1',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Taro',    '14',   '7',     '18',       '2',      '6',        '11',       '3',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Yuki',    '3',    '3',     '4',        '2',      '10',       '3',        '4',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Kyo',     '8',    '8',     '10',       '2',      '8',        '8',        '6',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Ines MANSOURI',  '1', '9', '2',        '2',      '1',       '16',       '7',     '2');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Akira',   '12',   '5',     '15',       '2',      '5',        '5',        '8',     '2');



-- Creer une partie 3
INSERT INTO `match_game` (`date_heure_m`, `Id_Map`, `Id_Resultat`) VALUES ('2022-08-23 08:42:37', '4', '1');

--  Partie 3
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Mio',     '7',    '7',     '9',        '1',      '12',       '10',       '9',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Ayane',   '5',    '2',     '6',        '1',      '2',        '15',       '2',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Biblorq', '15',   '4',     '17',      '1',      '7',        '13',       '6',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Lorel',   '10',   '9',     '12',       '1',      '1',       '20',       '5',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Tanpo',   '8',    '7',     '10',       '1',      '1',       '1',        '2',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Chouette','16',   '4',     '18',       '2',      '2',       '7',        '6',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Soryu',   '15',   '12',    '9',       '2',      '3',        '3',        '7',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Titi66',  '2',    '8',     '3',       '2',      '1',        '12',       '3',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Tutur34', '1',    '9',     '2',        '2',      '5',        '16',       '7',     '3');
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Shin',    '7',    '4',     '8',        '2',      '8',        '9',        '1',     '3');

-- Dernier test
INSERT INTO joueur (nom_uti_j, tue_j, mort_j, assist_j, Id_Equipe, Id_Arme, Id_Personnage, Id_Rang, Id_Match_game) VALUES
    (               'Mésange', '4',    '9',     '5',        '2',      '6',        '14',       '9',     '4');







-- Modifier une partie
UPDATE `match_game` SET `Id_Map` = '2', `Id_Resultat` = '2' WHERE `match_game`.`Id_Match_game` = 1;



-- Supprimer une partie
DELETE FROM joueur WHERE `joueur`.`Id_Match_game` = 2;
DELETE FROM match_game WHERE `match_game`.`Id_Match_game` = 2



-- Tous les joueurs
SELECT nom_uti_j AS 'Pseudo', equipe_sel_e AS 'Equipe', tue_j AS 'Kill', mort_j AS 'Death', assist_j AS 'Assist', nom_p AS 'Agent', joueur.Id_Match_game AS 'Num Partie', nom_m AS 'Nom Carte'
FROM `joueur`
INNER JOIN match_game ON joueur.Id_Match_game = match_game.Id_Match_game 
INNER JOIN map ON match_game.Id_Map = map.Id_Map 
INNER JOIN personnage ON joueur.Id_Personnage = personnage.Id_Personnage 
INNER JOIN equipe ON joueur.Id_Equipe = equipe.Id_Equipe
ORDER BY nom_uti_j ASC;



-- Joueur avec le plus de kill 
SELECT nom_uti_j , equipe_sel_e , tue_j , mort_j , assist_j , nom_p  
FROM joueur 
INNER JOIN personnage ON joueur.Id_Personnage = personnage.Id_Personnage 
INNER JOIN equipe ON joueur.Id_Equipe = equipe.Id_Equipe 
ORDER BY `tue_j` DESC 
LIMIT 1;


-- Tri Alphabetique ASC des Pseudo pour une seule équipe
SELECT nom_uti_j AS `Pseudo`, equipe_sel_e AS `Equipe`, rang_r AS `Rang`, tue_j AS `Kill`, mort_j AS `Death`, assist_j AS `Assist`, Id_Match_game AS `Num Partie` 
FROM joueur 
INNER JOIN equipe ON joueur.Id_Equipe = equipe.Id_Equipe 
INNER JOIN rang ON joueur.Id_Rang = rang.Id_Rang 
WHERE equipe_sel_e = 'Bleu' 
ORDER BY `nom_uti_j` ASC


-- L'arme la plus utilisée
SELECT COUNT(joueur.Id_Arme) AS 'Nmb Utilisé', nom_a AS "Nom de l\'Arme", type_a AS "Type d\'Arme", description_a AS 'Description' 
FROM joueur
INNER JOIN arme ON joueur.Id_Arme = arme.Id_Arme 
GROUP BY joueur.Id_Arme
ORDER BY COUNT(joueur.Id_Arme) DESC



-- Recepitulatif Global d'un match
SELECT nom_uti_j AS 'Pseudo', equipe_sel_e AS 'Equipe',tue_j AS 'Kill', mort_j AS 'Death', assist_j AS 'Assist', nom_p AS 'Agent' FROM joueur
INNER JOIN personnage ON joueur.Id_Personnage = personnage.Id_Personnage 
INNER JOIN equipe ON joueur.Id_Equipe = equipe.Id_Equipe
WHERE joueur.Id_Match_game = 1;

-- Recepitulatif Detaillé d'1 joueur
SELECT nom_uti_j AS "Pseudo", equipe_sel_e AS "Equipe", nom_m AS  "Carte",nom_p AS "Agent", nom_a AS "Arme", rang_r AS "Rang", tue_j AS "Kill", mort_j AS "Death", assist_j AS "Assist", joueur.Id_Match_game AS "Num Partie" FROM joueur 
INNER JOIN equipe ON joueur.Id_Equipe = equipe.Id_Equipe 
INNER JOIN rang ON joueur.Id_Rang = rang.Id_Rang 
INNER JOIN arme ON joueur.Id_Arme = joueur.Id_Arme
INNER JOIN personnage ON personnage.Id_Personnage = personnage.Id_Personnage
INNER JOIN match_game ON joueur.Id_Match_game = match_game.Id_Match_game 
INNER JOIN map ON match_game.Id_Map = map.Id_Map
WHERE equipe_sel_e = 'Bleu' 
ORDER BY nom_uti_j ASC
LIMIT 1;

-- Statistiques détaillées sur un élément
SELECT * FROM `personnage`;